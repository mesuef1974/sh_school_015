<!-- ุจุณู ุงููู ุงูุฑุญูู ุงูุฑุญูู -->
<div dir="rtl" lang="ar">

# โ๐ซ ูุธุงู ุฅุฏุงุฑุฉ ูุฏุฑุณุฉ ุงูุดุญุงููุฉ - sh_school_015

<div dir="ltr">

[![CI](https://github.com/mesuef1974/sh_school_015/actions/workflows/python-ci.yml/badge.svg)](https://github.com/mesuef1974/sh_school_015/actions/workflows/python-ci.yml)
[![Links](https://github.com/mesuef1974/sh_school_015/actions/workflows/links-validate.yml/badge.svg)](https://github.com/mesuef1974/sh_school_015/actions/workflows/links-validate.yml)
[![CodeQL](https://github.com/mesuef1974/sh_school_015/actions/workflows/codeql.yml/badge.svg)](https://github.com/mesuef1974/sh_school_015/actions/workflows/codeql.yml)
[![License: MIT](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

</div>

โูุธุงู ุฅุฏุงุฑุฉ ูุฏุฑุณูุฉ ูุชูุงูู ููุฏุฑุณุฉ ุงูุดุญุงููุฉ ุงูุฅุนุฏุงุฏูุฉ ุงูุซุงูููุฉ ูู ูุทุฑ. ูููุฑ ุฅุฏุงุฑุฉ ุดุงููุฉ ููุทูุงุจุ ุงูููุธูููุ ุงูุตูููุ ุงูุฃูุตุจุฉ ุงูุชุฏุฑูุณูุฉุ ูุน ูุงุฌูุฉ ุนุฑุจูุฉ (RTL) ุงุญุชุฑุงููุฉ ูููุฒุงุช ุชุตุฏูุฑ ูุชูุฏูุฉ.

---

## ๐ ุฌุฏูู ุงููุญุชููุงุช

- [ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ](#-ุงูููุฒุงุช-ุงูุฑุฆูุณูุฉ)
- [ุงูุจููุฉ ุงูุชูููุฉ](#-ุงูุจููุฉ-ุงูุชูููุฉ)
- [ุงููุชุทูุจุงุช](#-ุงููุชุทูุจุงุช)
- [ุงูุชุซุจูุช ูุงูุฅุนุฏุงุฏ](#-ุงูุชุซุจูุช-ูุงูุฅุนุฏุงุฏ)
- [ุงูุชุดุบูู](#-ุงูุชุดุบูู)
- [ุงูููุฒุงุช ุงููุชูุฏูุฉ](#-ุงูููุฒุงุช-ุงููุชูุฏูุฉ)
- [ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช](#-ุงุณุชูุฑุงุฏ-ุงูุจูุงูุงุช)
- [ุงููุณุฎ ุงูุงุญุชูุงุทู](#-ุงููุณุฎ-ุงูุงุญุชูุงุทู)
- [ุฃูุซูุฉ API](#-ุฃูุซูุฉ-api)
- [ุงุณุชูุดุงู ุงูุฃุฎุทุงุก](#-ุงุณุชูุดุงู-ุงูุฃุฎุทุงุก)
- [ุงููุณุงููุฉ](#-ุงููุณุงููุฉ)

---

## โจ ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

### ๐ฏ ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ
- **ุงูุทูุงุจ** - ุฅุฏุงุฑุฉ ูุงููุฉ ููุทูุงุจ ูุน ุงูุฑูู ุงููุทููุ ุชุงุฑูุฎ ุงููููุงุฏุ ุงูุฌูุณูุฉุ ูุจูุงูุงุช ููู ุงูุฃูุฑ
- **ุงูููุธููู** - ุฅุฏุงุฑุฉ ุงููุนูููู ูุงูุฅุฏุงุฑููู ูุน ุงูุชุฎุตุตุงุช ูุงูุตูุงุญูุงุช
- **ุงูุตููู** - ุฅุฏุงุฑุฉ ุงูุตููู ุงูุฏุฑุงุณูุฉ ูุงูุดุนุจ
- **ุงูููุงุฏ** - ุฅุฏุงุฑุฉ ุงูููุงุฏ ุงูุฏุฑุงุณูุฉ ูุน ุฑุจุทูุง ุจุงูุตููู

### ๐ ููุญุฉ ุงูุฃูุตุจุฉ ุงูุชุฏุฑูุณูุฉ (`/loads/`)
- ุนุฑุถ ูุฅุฏุงุฑุฉ ุงูุฃูุตุจุฉ ุงูุชุฏุฑูุณูุฉ ุจุดูู ุชูุงุนูู
- ุงุณุชูุฑุงุฏ ูู Excel (sync/async) ูุน ูุนุงูุฌุฉ ุฐููุฉ
- ููุชุฑุฉ ูุชูุฏูุฉ: ูุนููุ ุตูุ ูุงุฏุฉุ ุจุญุซ ูุตู
- ุชุฑุชูุจ ุฐูู ุญุณุจ ุงูุชุฎุตุต ูุงูุฃููููุฉ
- ุฅุญุตุงุฆูุงุช KPI: ุฅุฌูุงูู ุงูุญุตุตุ ุงููุฌูุงุชุ ุงูุชุบุทูุฉ
- ุฑุณูู ุจูุงููุฉ ุชูุงุนููุฉ ููุชูุฒูุน
- **ุชุตุฏูุฑ Excel**: ูููุงุช ุงุญุชุฑุงููุฉ ุจุชูุณูู A3 landscape ูุน ุฃููุงู ูุชุฌููุน
- **ุชุตุฏูุฑ PDF**: ุฏุนู WeasyPrint (preferred) ูุน fallback ูู ReportLab

### ๐จ ูุตูููุฉ ุงูุฃูุตุจุฉ (`/loads/matrix/`)
- ุนุฑุถ Matrix: ูุนูู ร ุตู (Teacher-Class Matrix)
- ุชุนุฏูู inline ููุฎูุงูุง ุนุจุฑ AJAX ุจุฏูู reload
- ุฃููุงู ุชุตููููุฉ ุญุณุจ ุงูุชุฎุตุต
- Tooltips ููููุงุฏ ุงููุชุนุฏุฏุฉ
- **ุชุตุฏูุฑ Excel/PDF**: ุจุชูุณูู ุงุญุชุฑุงูู ูุน ุฏุนู RTL

### ๐ค ููุฒุงุช ุงูุชุตุฏูุฑ ุงููุชูุฏูุฉ
| ุงูููุน | ุงููุณุงุฑ | ุงููุตู |
|------|--------|-------|
| Excel | `/loads/export/assignments.xlsx` | ุชุตุฏูุฑ ุฌุฏูู ุงูุฃูุตุจุฉ ุจุชูุณูู A3 |
| PDF | `/loads/export/assignments.pdf` | ุชุตุฏูุฑ PDF ููุฃูุตุจุฉ (WeasyPrint/ReportLab) |
| Excel | `/loads/matrix/export.xlsx` | ุชุตุฏูุฑ ูุตูููุฉ ุงููุนูููู ูุงูุตููู |
| PDF | `/loads/matrix/export.pdf` | ุชุตุฏูุฑ PDF ูููุตูููุฉ |
| CSV | `/data/<table>/export` | ุชุตุฏูุฑ ุณุฑูุน ูุฃู ุฌุฏูู ุจูุงูุงุช |

### ๐ ุงูุฃูุงู ูุงูุตูุงุญูุงุช
- ูุธุงู ุตูุงุญูุงุช RBAC ูุชูุฏู
- ูุฌููุนุงุช: Admin, Principal, Teachers, Staff
- JWT authentication ููู API
- Django Admin ูุน ุชุฎุตูุตุงุช ุนุฑุจูุฉ

### ๐ ูุงุฌูุฉ ุนุฑุจูุฉ ุงุญุชุฑุงููุฉ
- ุฏุนู ูุงูู ููุบุฉ ุงูุนุฑุจูุฉ (RTL)
- ุฎุทูุท ุนุฑุจูุฉ ูุฏูุฌุฉ (Noto Kufi Arabic, Amiri)
- Bootstrap 5 ูุน ุชุฎุตูุตุงุช ุนุฑุจูุฉ
- HTMX ููุชุญุฏูุซุงุช ุงูุฏููุงููููุฉ ุจุฏูู JavaScript

---

## ๐ ุงูุจููุฉ ุงูุชูููุฉ

### Backend Stack
- **Framework**: Django 5.1.4 + Django REST Framework 3.15
- **Database**: PostgreSQL 16 (ุนุจุฑ Docker)
- **Task Queue**: Redis + RQ (django-rq) ููููุงู ุงูุฎูููุฉ
- **Authentication**: JWT (djangorestframework-simplejwt)
- **Export Libraries**:
  - Excel: `openpyxl`
  - PDF: `WeasyPrint` (preferred) / `ReportLab` (fallback)
  - Arabic support: `arabic-reshaper`, `python-bidi`

### Frontend
- HTML5 + CSS3 (Bootstrap 5)
- HTMX ููุชูุงุนููุฉ
- Chart.js ููุฑุณูู ุงูุจูุงููุฉ
- ุฎุทูุท ุนุฑุจูุฉ ูุฏูุฌุฉ

### DevOps
- Docker & Docker Compose
- GitHub Actions CI/CD
- Health endpoints (`/livez`, `/healthz`)
- Environment-based settings (dev/prod)

---

## ๐ฆ ุงููุชุทูุจุงุช

### ุงูุฃุณุงุณูุฉ
- **Python 3.11+** (Python 3.11 ุฃู ุฃุญุฏุซ)
- **Docker Desktop** (ูุชุดุบูู PostgreSQL ู Redis)
- **Git** (ููุชุญูู ุจุงูุฅุตุฏุงุฑุงุช)

### ููุชุตุฏูุฑ PDF (ุงุฎุชุฑ ูุงุญุฏุฉ)

**ุงูุทุฑููุฉ ุงูููุตู ุจูุง:**

<div dir="ltr">

```powershell
pip install WeasyPrint>=60.0
```

</div>

**ุงูุจุฏูู (ReportLab):**

<div dir="ltr">

```powershell
pip install reportlab>=4.0 arabic-reshaper python-bidi
```

</div>

### ููุชุตุฏูุฑ Excel

<div dir="ltr">

```powershell
pip install openpyxl>=3.1.0
```

</div>

---

## ๐ ุงูุชุซุจูุช ูุงูุฅุนุฏุงุฏ

### 1๏ธโฃ ุฅุนุฏุงุฏ ุจูุฆุฉ ุงูุชุทููุฑ (Windows)

ุงูุณูุฑุจุช ูููู ุจูู ุดูุก ุชููุงุฆูุงู:

<div dir="ltr">

```powershell
# ูู ุฌุฐุฑ ุงููุดุฑูุน
./scripts/dev_setup.ps1
```

</div>

**ูุงุฐุง ููุนูุ**
- โ ููุดุฆ ุจูุฆุฉ ุงูุชุฑุงุถูุฉ `.venv` (ุฃู ูุตูุญ ุงูุชุงููุฉ)
- โ ููุนูู ุงูุจูุฆุฉ ููุญุฏูุซ pip
- โ ูุซุจูุช ุงูุงุนุชูุงุฏูุงุช ูู `requirements-dev.txt`
- โ ูุดุบูู ูุญูุตุงุช Black ู Flake8
- โ ูุชุญูู ูู `gen_index.py`

**ููุฅุนุฏุงุฏ ุงููุฏูู:**

<div dir="ltr">

```powershell
python -m venv .venv
.\.venv\Scripts\Activate.ps1
python -m pip install --upgrade pip
pip install -r requirements.txt
pip install -r requirements-dev.txt
```

</div>

### 2๏ธโฃ ุฅุนุฏุงุฏ ููู ุงูุจูุฆุฉ

ุงูุณุฎ ุงูููู ุงููููุฐุฌู ูุนุฏููู:

<div dir="ltr">

```powershell
cp backend/.env.example backend/.env
```

</div>

**ูุญุชูู `.env` ุงูุฃุณุงุณู:**

<div dir="ltr">

```env
# Django Settings
DJANGO_SECRET_KEY=change-me-very-secret-key-here
DJANGO_DEBUG=True
DJANGO_ALLOWED_HOSTS=127.0.0.1,localhost
DJANGO_ENV=dev

# PostgreSQL (Docker Container)
PG_DB=sh_school
PG_USER=postgres
PG_PASSWORD=postgres
PG_HOST=127.0.0.1
PG_PORT=5433

# Auto-create Superuser (optional)
DJANGO_SUPERUSER_USERNAME=admin
DJANGO_SUPERUSER_EMAIL=admin@school.qa
DJANGO_SUPERUSER_PASSWORD=Admin@12345

# Server Settings (optional)
DJANGO_RUN_HOST=0.0.0.0
DJANGO_RUN_PORT=8000
```

</div>

---

## โถ๏ธ ุงูุชุดุบูู

### ุงูุชุดุบูู ุงูุณุฑูุน (ุงููู ูุนุงู)

<div dir="ltr">

```powershell
# ุชุดุบูู ูู ุงูููููุงุช ุฏูุนุฉ ูุงุญุฏุฉ
./scripts/dev_up.ps1
```

</div>

**ูุงุฐุง ูุญุฏุซุ**
1. โ ูุดุบูู PostgreSQL (ุญุงููุฉ `pg-sh-school`)
2. โ ูุดุบูู Redis (ุญุงููุฉ `redis-sh`)
3. โ ูุทุจูู ุงููุฌุฑุงุช (migrations)
4. โ ููุดุฆ ุงูุณูุจุฑ ููุฒุฑ ุชููุงุฆูุงู
5. โ ููููุฆ ุตูุงุญูุงุช RBAC
6. โ ูุดุบูู RQ Worker (ูุงูุฐุฉ ูููุตูุฉ)
7. โ ูุดุบูู ุงูุฎุงุฏู ุนูู HTTPS (8443) ุฃู HTTP (8000)
8. โ ููุชุญ ุงููุชุตูุญ ุชููุงุฆูุงู

### ุงูุชุดุบูู ุงููุชูุฏู (ุฎุทูุฉ ุจุฎุทูุฉ)

#### 1. ุชุดุบูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

<div dir="ltr">

```powershell
./scripts/db_up.ps1
```

</div>

#### 2. ุชุดุบูู ุงูุฎุงุฏู

<div dir="ltr">

```powershell
# HTTP ุนุงุฏู (ูููุฐ 8000)
./scripts/serve.ps1

# HTTPS ูุญูู (ูููุฐ 8443)
./scripts/serve_https.ps1
```

</div>

#### 3. ุชุดุบูู RQ Worker (ุงุฎุชูุงุฑู - ููููุงู ุงูุฎูููุฉ)

<div dir="ltr">

```powershell
./scripts/rq_worker.ps1
```

</div>

### ุงููุตูู ูููุธุงู

| ุงูุฎุฏูุฉ | ุงูุฑุงุจุท | ุงููุตู |
|--------|--------|-------|
| ููุญุฉ ุงูุฃูุตุจุฉ | http://127.0.0.1:8000/loads/ | ุงููุงุฌูุฉ ุงูุฑุฆูุณูุฉ |
| ูุตูููุฉ ุงูุฃูุตุจุฉ | http://127.0.0.1:8000/loads/matrix/ | Teacher-Class Matrix |
| ูุนุงููุฉ ุงูุจูุงูุงุช | http://127.0.0.1:8000/data/ | CRUD ููุฌุฏุงูู |
| Django Admin | http://127.0.0.1:8000/admin/ | ููุญุฉ ุงูุฅุฏุงุฑุฉ |
| API Root | http://127.0.0.1:8000/api/ | REST API |
| Health Check | http://127.0.0.1:8000/healthz | ูุญุต ุงูุตุญุฉ |
| OpenAPI Docs | http://127.0.0.1:8000/api/docs/ | ุชูุซูู API |

---

## ๐ ุงูููุฒุงุช ุงููุชูุฏูุฉ

### 1๏ธโฃ ุฅูุดุงุก/ุชุญุฏูุซ ุงูุณูุจุฑ ููุฒุฑ

**ุงูุทุฑููุฉ ุงูููุตู ุจูุง:**

<div dir="ltr">

```powershell
./scripts/ensure_superuser.ps1 --username admin.pro --email admin@school.qa --password "StrongP@ssw0rd!"
```

</div>

**ุนุจุฑ Django ูุจุงุดุฑุฉ:**

<div dir="ltr">

```powershell
python backend/manage.py ensure_superuser --username admin.pro --email admin@school.qa --password "StrongP@ssw0rd!"
```

</div>

**ุฃู ุนุจุฑ `.env`:** (ุชููุงุฆูุงู ุนูุฏ `./scripts/serve.ps1`)

<div dir="ltr">

```env
DJANGO_SUPERUSER_USERNAME=admin.pro
DJANGO_SUPERUSER_EMAIL=admin@school.qa
DJANGO_SUPERUSER_PASSWORD=StrongP@ssw0rd!
```

</div>

### 2๏ธโฃ HTTPS ุงููุญูู (ููุชุทููุฑ)

**ุชูููุฏ ุดูุงุฏุฉ ุฐุงุชูุฉ:**

<div dir="ltr">

```powershell
./scripts/make_dev_cert.ps1
```

</div>


**ุชุดุบูู HTTPS:**

<div dir="ltr">

```powershell
./scripts/serve_https.ps1
# ููุชุญ ุนูู: https://127.0.0.1:8443/
```

</div>


**ุฅุฒุงูุฉ ุชุญุฐูุฑ "Not secure":**

<div dir="ltr">

```powershell
# ุชุซุจูุช ุงูุดูุงุฏุฉ ูู Windows Trust Store
./scripts/trust_dev_cert.ps1

# ูุฅุฒุงูุชูุง ูุงุญูุงู
./scripts/trust_dev_cert.ps1 -Untrust
```

</div>


### 3๏ธโฃ ุจูุฆุงุช ุงูุฅุนุฏุงุฏุงุช (Dev/Prod)

**ุงูุชุจุฏูู ุจูู ุงูุจูุฆุงุช:**

<div dir="ltr">

```powershell
# Development (ุงูุชุฑุงุถู)
$env:DJANGO_ENV='dev'
python backend/manage.py runserver

# Production (ูุญููุงู ููุงุฎุชุจุงุฑ)
$env:DJANGO_ENV='prod'
$env:DJANGO_ALLOWED_HOSTS='localhost,127.0.0.1'
python backend/manage.py runserver
```

</div>


**ูููุงุช ุงูุฅุนุฏุงุฏุงุช:**
- `backend/core/settings_base.py` - ุฅุนุฏุงุฏุงุช ูุดุชุฑูุฉ
- `backend/core/settings_dev.py` - ุงูุชุทููุฑ (DEBUG=True, CORS open)
- `backend/core/settings_prod.py` - ุงูุฅูุชุงุฌ (SECURE_*, HSTS, whitelists)

### 4๏ธโฃ Health Checks

| Endpoint | ุงููุตู | ุงูุงุณุชุฌุงุจุฉ |
|----------|-------|-----------|
| `/livez` | Liveness Probe | 204 No Content |
| `/healthz` | Readiness Probe (DB check) | 200 OK / 500 Error |

**ุนุจุฑ Command Line:**

<div dir="ltr">

```powershell
# ูุทุจุน "ok" ุฃู ุฑุณุงูุฉ ุงูุฎุทุฃุ exit code: 0 ุฃู 1
python backend/manage.py healthcheck
```

</div>


**Smoke Test ุณุฑูุน:**

<div dir="ltr">

```powershell
./scripts/smoke.ps1
# ููุญุต /livez ู /healthz
```

</div>


---

## ๐ฅ ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช

### 1๏ธโฃ ุงุณุชูุฑุงุฏ ุงูุทูุงุจ ูู Excel

**ุฏุนู ุดูุช ููู ุตู:**

<div dir="ltr">

```powershell
# ุชุฌุฑุจุฉ ุจุฏูู ูุชุงุจุฉ (Dry-Run)
python backend/manage.py import_students "D:\path\to\students.xlsx" --all-sheets --sheet-per-class --dry-run

# ุชูููุฐ ูุนูู
python backend/manage.py import_students "D:\path\to\students.xlsx" --all-sheets --sheet-per-class
```

</div>


**ูุณุญ ุงูุจูุงูุงุช ุงููุฏููุฉ ูุฅุนุงุฏุฉ ุงูุงุณุชูุฑุงุฏ:**

<div dir="ltr">

```powershell
python backend/manage.py import_students "D:\path\to\students.xlsx" \
    --all-sheets \
    --sheet-per-class \
    --clean \
    --nationality-xlsx "D:\path\to\nationalities.xlsx" \
    --expect-total 742
```

</div>


**ุงูุฃุนูุฏุฉ ุงููุชููุนุฉ ูู Excel:**
- `national_no` - ุงูุฑูู ุงููุทูู (ููุชุงุญ ุฃุณุงุณู)
- `studant_name` - ุงุณู ุงูุทุงูุจ ุจุงูุนุฑุจูุฉ
- `studant_englisf_name` - ุงูุงุณู ุจุงูุฅูุฌููุฒูุฉ
- `date_of_birth` - ุชุงุฑูุฎ ุงููููุงุฏ (ูุชู ุญุณุงุจ ุงูุนูุฑ ุชููุงุฆูุงู)
- `nationality` ุฃู `ุงูุฌูุณูุฉ` - ุงูุฌูุณูุฉ
- `grade` - ุฑูู ุงูุตู (ููุณุชุฎุฑุฌ ูู ุงุณู ุงูุดูุช ุฅู ูู ููุฌุฏ)
- `section` - ุงูุดุนุจุฉ (ููุณุชุฎุฏู ุงุณู ุงูุดูุช ุฅู ูู ููุฌุฏ)
- `stu_phone_no` - ุฌูุงู ุงูุทุงูุจ
- `stu_email` - ุจุฑูุฏ ุงูุทุงูุจ
- `parent_national_no` - ุงูุฑูู ุงููุทูู ูููู ุงูุฃูุฑ
- `name_parent` - ุงุณู ููู ุงูุฃูุฑ
- `relation_parent` - ุนูุงูุฉ ููู ุงูุฃูุฑ
- `extra_phone_no` - ุฃุฑูุงู ุฅุถุงููุฉ
- `parent_email` - ุจุฑูุฏ ููู ุงูุฃูุฑ

**ุฎูุงุฑุงุช ูุชูุฏูุฉ:**
- `--wipe` / `--clean` - ูุณุญ ุฌููุน ุงูุทูุงุจ ูุจู ุงูุงุณุชูุฑุงุฏ
- `--nationality-xlsx` - ููู ุฅุถุงูู ููุฌูุณูุงุช
- `--expect-total N` - ุงูุชุญูู ูู ุนุฏุฏ ุงูุณุฌูุงุช ุงููุณุชูุฑุฏุฉ

### 2๏ธโฃ ุงุณุชูุฑุงุฏ ุงูุฃูุตุจุฉ ูู Excel

**ุงุณุชูุฑุงุฏ ุนุงุฏู:**

<div dir="ltr">

```powershell
python backend/manage.py import_loads "D:\path\to\loads.xlsx"
```

</div>


**ุนุจุฑ ุงููุงุฌูุฉ:** ุงุฐูุจ ุฅูู `/loads/` ูุงุถุบุท "ุงุณุชูุฑุงุฏ Excel"

### 3๏ธโฃ ุงุณุชูุฑุงุฏ ุงูุฌุฏุงูู ูู PDF

**ูุฏุนู tabula-py (ูุน Java) ุฃู pdfplumber (ุจุฏูู Java):**

<div dir="ltr">

```powershell
# ุชุฌุฑุจุฉ
./scripts/backend_run.ps1 import_from_pdf "D:\path\to\pdfs" --dry-run

# ุชูููุฐ ูุนูู
./scripts/backend_run.ps1 import_from_pdf "D:\path\to\pdfs"
```

</div>


**ูุชุทูุจุงุช:**
- **Tabula (preferred):** ูุญุชุงุฌ Java ุนูู ุงููุธุงูุ ูุชุงุฆุฌ ุฃูุถู ููุฌุฏุงูู ุงูุดุจููุฉ
- **pdfplumber (fallback):** ุจุฏูู Javaุ ูุนูู ุชููุงุฆูุงู ุฅุฐุง ูุดู tabula

---

## ๐พ ุงููุณุฎ ุงูุงุญุชูุงุทู ูุงูุงุณุชุนุงุฏุฉ

### ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ

**ุนุจุฑ Django Command (ููุตู ุจู):**

<div dir="ltr">

```powershell
cd backend

# ููู SQL ุนุงุฏู (ูู backups/)
python manage.py backup_db

# ูุถุบูุท gzip
python manage.py backup_db --gzip

# ูุฌูุฏ ูุฎุตุต
python manage.py backup_db --out "D:\my_backups"
```

</div>


**ุนุจุฑ PowerShell Script:**

<div dir="ltr">

```powershell
./scripts/db_backup.ps1           # SQL ุนุงุฏู
./scripts/db_backup.ps1 -Gzip     # ูุถุบูุท
./scripts/db_backup.ps1 -OutDir "D:\my_backups"
```

</div>


### ุงุณุชุนุงุฏุฉ ูุณุฎุฉ ุงุญุชูุงุทูุฉ


<div dir="ltr">

```powershell
# ุงุณุชุนุงุฏุฉ ูุน ุชุฃููุฏ
./scripts/db_restore.ps1 "D:\sh_school_015\backups\pg_backup_sh_school_20251010_144522.sql"

# ุงุณุชุนุงุฏุฉ ูุจุงุดุฑุฉ ุจุฏูู ุชุฃููุฏ
./scripts/db_restore.ps1 "D:\backups\backup.sql" -Force

# ุงุณุชุนุงุฏุฉ ุจุฏูู ุญุฐู public schema (ุบูุฑ ูุณุชุญุณู)
./scripts/db_restore.ps1 "D:\backups\backup.sql" -SkipDrop
```

</div>


**ููุงุญุธุงุช:**
- ุชุชู ุงูุนูููุฉ ุฏุงุฎู ุญุงููุฉ Docker `pg-sh-school`
- ูุชู ูุฑุงุกุฉ ุจูุงูุงุช ุงูุงุชุตุงู ูู `backend/.env`
- ุงูุณูุฑุจุช ูุฏุนู ูููุงุช `.sql` ู `.sql.gz`

---

## ๐ ุฃูุซูุฉ API

### ุงูุญุตูู ุนูู JWT Token

**PowerShell (Invoke-RestMethod):**

<div dir="ltr">

```powershell
$resp = Invoke-RestMethod -Method Post -Uri "http://127.0.0.1:8000/api/token/" `
    -ContentType 'application/json' `
    -Body (@{ username = 'admin'; password = 'Admin@12345' } | ConvertTo-Json)

$access = $resp.access
$refresh = $resp.refresh
$access  # ุนุฑุถ ุงูุชููู
```

</div>


**cURL (ุณุทุฑ ูุงุญุฏ):**

<div dir="ltr">

```powershell
curl -X POST "http://127.0.0.1:8000/api/token/" `
    -H "Content-Type: application/json" `
    -d '{"username":"admin","password":"Admin@12345"}'
```

</div>


### ุงุณุชุฏุนุงุก API

**PowerShell:**

<div dir="ltr">

```powershell
# ุงูุตููู
Invoke-RestMethod -Uri 'http://127.0.0.1:8000/api/classes/' `
    -Headers @{ Authorization = "Bearer $access" }

# ุงูุทูุงุจ
Invoke-RestMethod -Uri 'http://127.0.0.1:8000/api/students/' `
    -Headers @{ Authorization = "Bearer $access" }

# ุงูุฃูุตุจุฉ ุงูุชุฏุฑูุณูุฉ
Invoke-RestMethod -Uri 'http://127.0.0.1:8000/api/teaching-assignments/' `
    -Headers @{ Authorization = "Bearer $access" }
```

</div>


**cURL:**

<div dir="ltr">

```powershell
curl "http://127.0.0.1:8000/api/classes/" -H "Authorization: Bearer $access"
```

</div>


### Endpoints ุงููุชุงุญุฉ

| Endpoint | Method | ุงููุตู |
|----------|--------|-------|
| `/api/token/` | POST | ุงูุญุตูู ุนูู access + refresh tokens |
| `/api/token/refresh/` | POST | ุชุฌุฏูุฏ access token |
| `/api/classes/` | GET, POST | ูุงุฆูุฉ/ุฅูุดุงุก ุงูุตููู |
| `/api/students/` | GET, POST | ูุงุฆูุฉ/ุฅูุดุงุก ุงูุทูุงุจ |
| `/api/staff/` | GET, POST | ูุงุฆูุฉ/ุฅูุดุงุก ุงูููุธููู |
| `/api/subjects/` | GET, POST | ูุงุฆูุฉ/ุฅูุดุงุก ุงูููุงุฏ |
| `/api/teaching-assignments/` | GET, POST | ูุงุฆูุฉ/ุฅูุดุงุก ุงูุฃูุตุจุฉ |
| `/api/class-subjects/` | GET, POST | ุฑุจุท ุงูููุงุฏ ุจุงูุตููู |

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดุงูู PostgreSQL

**ุฎุทุฃ: "docker: Error response from daemon: Conflict"**

<div dir="ltr">

```powershell
# ุงุญุฐู ุงูุญุงููุฉ ูุงูู volume ูุฃุนุฏ ุงูุชุดุบูู
docker rm -f pg-sh-school
docker volume rm pg-sh-school-data
./scripts/serve.ps1
```

</div>


**ุฎุทุฃ: "FATAL: password authentication failed"**

<div dir="ltr">

```powershell
# ุชุฃูุฏ ูู ุชุทุงุจู PG_USER/PG_PASSWORD ูู .env ูุน ุงูุญุงููุฉ
# ุซู ุงุญุฐู ุงูู volume ูุฃุนุฏ ุงูุฅูุดุงุก
docker volume rm pg-sh-school-data
./scripts/db_up.ps1
```

</div>


**ุฎุทุฃ: "port 5433 already in use"**

<div dir="ltr">

```powershell
# ุบููุฑ PG_PORT ูู .env
# ูุซูุงู: PG_PORT=5434
```

</div>


### ูุดุงูู ุงูุชุตุฏูุฑ

**ุฎุทุฃ: "WeasyPrint not available"**

<div dir="ltr">

```powershell
# ูุชู ุงุณุชุฎุฏุงู ReportLab ุชููุงุฆูุงู ูู fallback
# ูุชุซุจูุช WeasyPrint:
pip install WeasyPrint>=60.0
```

</div>


**PDF ูุธูุฑ ูุฑุจุนุงุช ุจุฏู ุงูุนุฑุจู:**

<div dir="ltr">

```powershell
# ุชุฃูุฏ ูู ูุฌูุฏ ุฎุทูุท ุนุฑุจูุฉ ูู:
# backend/static/fonts/
# ุฃู ุงุณุชุฎุฏู ReportLab ูุน:
pip install arabic-reshaper python-bidi
```

</div>


**ุฎุทุฃ: "openpyxl not found"**

<div dir="ltr">

```powershell
pip install openpyxl>=3.1.0
```

</div>


### ูุดุงูู ุงูุงุณุชูุฑุงุฏ

**ุฎุทุฃ: "ImportError: No module named 'django'"**

<div dir="ltr">

```powershell
# ุชุฃูุฏ ูู ุชูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ
.\.venv\Scripts\Activate.ps1
pip install -r requirements.txt
```

</div>


**ุฎุทุฃ: "java command is not found" (ุนูุฏ ุงุณุชูุฑุงุฏ PDF)**

<div dir="ltr">

```powershell
# ูุฐุง ุทุจูุนู - ุณูุณุชุฎุฏู pdfplumber ุชููุงุฆูุงู
# ูุชุซุจูุช Java (ุงุฎุชูุงุฑู):
# ูู ุจุชุซุจูุช Java JDK 8+ ูู oracle.com
```

</div>


### ูุดุงูู HTTPS ุงููุญูู

**ุชุญุฐูุฑ: "You're accessing the development server over HTTPS"**

<div dir="ltr">

```powershell
# ุงุณุชุฎุฏู HTTP ุตุฑูุญุงู:
http://127.0.0.1:8000/

# ุฃู ุดุบูู HTTPS ุงูุตุญูุญ:
./scripts/serve_https.ps1
# ุณููุชุญ ุนูู: https://127.0.0.1:8443/
```

</div>


**ุฎุทุฃ: "SSL certificate verify failed"**

<div dir="ltr">

```powershell
# ุซุจูุช ุงูุดูุงุฏุฉ ูู Windows:
./scripts/trust_dev_cert.ps1
```

</div>


---

## ๐จ ุชุฎุตูุต ุงููุงุฌูุฉ

### ุงูุฎุทูุท ุงูุนุฑุจูุฉ
ุงูุฎุทูุท ุงููุฏูุฌุฉ ูู `assets/fonts/`:
- **Noto Kufi Arabic** - ูููุตูุต ุงูุนุงูุฉ
- **Amiri** - ููุนูุงููู ูุงููุตูุต ุงูุชูููุฏูุฉ

ูุชุบููุฑ ุงูุฎุทูุทุ ุนุฏูู `@font-face` ูู ุงูููุงูุจ.

### ุงูุฃููุงู ูุงูุซูู
ุงูุฃููุงู ุงูุฃุณุงุณูุฉ ูู `:root` CSS variables:

<div dir="ltr">

```css
:root {
  --primary-color: #800000;    /* ุนูุงุจู */
  --secondary-color: #FFD700;  /* ุฐูุจู */
  --accent-color: #4A90E2;     /* ุฃุฒุฑู */
}
```

</div>


### ุชุฎุตูุต gen_index.py
ูุชุญุฏูุซ ูุงุฆูุฉ ุงููููุงุช ูู `index.html`:

<div dir="ltr">

```powershell
python gen_index.py        # ุชุญุฏูุซ
python gen_index.py --check  # ูุญุต ููุท
```

</div>


ุงููุชุบูุฑุงุช ูู `gen_index.py`:
- `INCLUDE_EXT` - ุงูุชุฏุงุฏุงุช ุงููููุงุช ุงููุฑุบูุจุฉ
- `EXCLUDE_DIRS` - ูุฌูุฏุงุช ูุณุชุซูุงุฉ
- `EXCLUDE_FILES` - ูููุงุช ูุญุฏุฏุฉ ูุณุชุซูุงุฉ

---

## ๐ ูุซุงุฆู ุฅุถุงููุฉ

- [RBAC Documentation](DOC/RBAC.md) - ูุธุงู ุงูุตูุงุญูุงุช
- [Security & Environment Variables](DOC/SECRETS_AND_ENV_ar.md) - ุงูุฃูุงู ูุงููุชุบูุฑุงุช
- [Strategic Plan 2025](DOC/STRATEGY_2025_PRO_ar.md) - ุงูุฎุทุฉ ุงูุงุณุชุฑุงุชูุฌูุฉ
- [Contributing Guidelines](CONTRIBUTING.md) - ุฏููู ุงููุณุงููุฉ
- [Code of Conduct](CODE_OF_CONDUCT.md) - ููุงุนุฏ ุงูุณููู
- [Security Policy](SECURITY.md) - ุณูุงุณุฉ ุงูุฃูุงู

---

## ๐ค ุงููุณุงููุฉ

ูุฑุญุจ ุจูุณุงููุงุชู! ููุฑุฌู ูุฑุงุกุฉ [CONTRIBUTING.md](CONTRIBUTING.md) ุฃููุงู.

### ุณูุฑ ุงูุนูู ุงูููุชุฑุญ

1. Fork ุงููุณุชูุฏุน
2. ุฃูุดุฆ branch ููููุฒุฉ: `git checkout -b feature/amazing-feature`
3. Commit ุงูุชุบููุฑุงุช: `git commit -m "Add amazing feature"`
4. Push ููู branch: `git push origin feature/amazing-feature`
5. ุงูุชุญ Pull Request

### ูุนุงููุฑ ุงูููุฏ

- **Black** ููุชูุณูู (line length: 100)
- **Flake8** ููู linting
- **Type hints** ุญูุซูุง ุฃููู
- **Docstrings** ููุฏูุงู ูุงูููุงุณุงุช

**ุชุดุบูู ุงููุญูุตุงุช:**

<div dir="ltr">

```powershell
./scripts/dev_checks.ps1
# ุฃู ูุฏููุงู:
black --check backend/
flake8 backend/ --max-line-length=100
python backend/manage.py test
```

</div>


---

## ๐ ุงูุฃูุงู

ูุชูุฏูู ุจูุงุบ ุฃูููุ ููุฑุฌู ูุฑุงุฌุนุฉ [SECURITY.md](SECURITY.md).

**Best Practices ููุฅูุชุงุฌ:**
- โ ุบููุฑ `DJANGO_SECRET_KEY` ุฅูู ูููุฉ ุนุดูุงุฆูุฉ ูููุฉ
- โ ุงุถุจุท `DJANGO_DEBUG=False`
- โ ุญุฏุฏ `DJANGO_ALLOWED_HOSTS` ุจุฏูุฉ
- โ ุงุณุชุฎุฏู HTTPS ููุท (TLS 1.2+)
- โ ูุนูู HSTS ู CSP headers
- โ ุงุณุชุฎุฏู PostgreSQL passwords ูููุฉ
- โ ูู ุจุงููุณุฎ ุงูุงุญุชูุงุทู ุจุงูุชุธุงู

---

## ๐ ุงูุชุฑุฎูุต

ูุฐุง ุงููุดุฑูุน ูุฑุฎุต ุจููุฌุจ [MIT License](LICENSE).


<div dir="ltr">

```
Copyright (c) 2025 ูุฏุฑุณุฉ ุงูุดุญุงููุฉ ุงูุฅุนุฏุงุฏูุฉ ุงูุซุงูููุฉ

Permission is hereby granted, free of charge, to any person obtaining a copy...
```

</div>


---

## ๐ ุงูุดูุฑ ูุงูุชูุฏูุฑ

- **Django** - ุฅุทุงุฑ ุงูุนูู ุงูุฃุณุงุณู
- **PostgreSQL** - ูุงุนุฏุฉ ุงูุจูุงูุงุช
- **Bootstrap** - ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
- **WeasyPrint** - ุชุตุฏูุฑ PDF ุงููุชูุฏู
- **ุงููุณุงูููู** - ุฌููุน ูู ุณุงูููุง ูู ูุฐุง ุงููุดุฑูุน

---

## ๐ ุงูุฏุนู ูุงูุงุชุตุงู

- **ุงููุณุชูุฏุน**: [github.com/mesuef1974/sh_school_015](https://github.com/mesuef1974/sh_school_015)
- **Issues**: [ุฅุจูุงุบ ุนู ูุดููุฉ](https://github.com/mesuef1974/sh_school_015/issues)
- **Pull Requests**: [ุงููุณุงููุงุช](https://github.com/mesuef1974/sh_school_015/pulls)

---

## ๐ ุงูุฅุญุตุงุฆูุงุช

- **ุงููุบุฉ ุงูุฑุฆูุณูุฉ**: Python ๐
- **ุงูุฅุตุฏุงุฑ**: 1.0.0
- **ุขุฎุฑ ุชุญุฏูุซ**: ุฃูุชูุจุฑ 2025
- **ุงูุญุงูุฉ**: ูุดุท โ

---

---

<div dir="ltr" align="center">

### Built with โค๏ธ for Shahania School, Qatar

**Made in Qatar ๐ถ๐ฆ | Powered by Django & PostgreSQL**

</div>

</div>
