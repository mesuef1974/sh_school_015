<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>خطة تطوير منصة المدرسة — واجهة تنفيذية</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../assets/fontawesome.min.css" />
  <!-- Fallback CDN for Font Awesome (fixes squares if local assets are missing) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="icon" href="../assets/brand-icon.svg" type="image/svg+xml" />
  <link rel="manifest" href="../assets/site.webmanifest" />
  <style>
    :root{
      --maroon: #7B1E1E; /* Maroon أساسي */
      --maroon-700: #6B1919;
      --maroon-600: #8B2323;
      --maroon-50: #F9F3F3;
      --sand: #F6EDE6;
      --ink: #1B1B1B;
      --muted: #6A6A6A;
      --success: #0E8F61;
      --warning: #B76E00;
      --info: #235E8C;
      --bg: #fff;
      --card: #fff;
      --radius: 14px;
      --shadow: 0 10px 25px rgba(0,0,0,0.08);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:linear-gradient(180deg,var(--sand),#fff 30%);
      color:var(--ink); font-family:'Tajawal',system-ui,Segoe UI,Arial; line-height:1.7;
    }
    a{color:var(--maroon-600); text-decoration:none}
    a:hover{text-decoration:underline}
    .container{max-width:1100px; margin-inline:auto; padding:24px}
    header.hero{
      background: radial-gradient(1200px 400px at 90% -50%, #C98C8C33, transparent),
                  linear-gradient(135deg, var(--maroon) 0%, var(--maroon-700) 60%);
      color:#fff; border-bottom:6px solid #B83C3C;
    }
    .hero .container{display:flex; gap:24px; align-items:center; padding-block:32px}
    .brand{
      width:72px; height:72px; border-radius:20px; background:#fff1; display:grid; place-items:center;
      border:1px solid #ffffff2a; box-shadow: inset 0 0 0 1px #0000001a;
    }
    .brand i{font-size:34px; color:#fff}
    .title h1{margin:0; font-weight:800; font-size:32px}
    .title p{margin:6px 0 0; color:#fffb; font-weight:500}
    .toolbar{margin-top:14px; display:flex; gap:10px; flex-wrap:wrap}
    .btn{
      display:inline-flex; gap:8px; align-items:center; padding:10px 14px;
      background:#fff; color:var(--maroon-700); border-radius:12px; border:0; cursor:pointer;
      box-shadow:var(--shadow); font-weight:700
    }
    .btn.secondary{background:#ffffff1a; color:#fff; border:1px solid #ffffff3d}
    .grid{display:grid; gap:18px}
    .cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}
    @media (max-width: 980px){ .cols-3{grid-template-columns:1fr} }

    .card{
      background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow);
      padding:18px 18px 10px; border-inline-start:6px solid var(--maroon);
    }
    .card h3{margin:0 0 6px; font-size:20px}
    .card .lead{color:var(--muted); margin:0 0 12px}

    .kpi{
      display:flex; gap:12px; align-items:center; background:var(--maroon-50);
      padding:12px; border-radius:12px; border:1px solid #E9D4D4
    }
    .kpi i{color:var(--maroon)}

    .section{margin-block:28px}
    .section h2{font-size:24px; margin:0 0 10px; color:var(--maroon-700)}

    .list{margin:0; padding:0; list-style:none; display:grid; gap:10px}
    .list li{display:flex; gap:10px; align-items:flex-start; background:#fff; border:1px solid #EEE; padding:12px; border-radius:12px}
    .list i{color:var(--maroon-600); margin-top:2px}
    .muted{color:var(--muted)}

    .timeline{position:relative; padding-right:20px}
    .timeline::before{content:''; position:absolute; right:8px; top:6px; bottom:6px; width:3px; background:#E2B9B9}
    .step{position:relative; padding:10px 12px; background:#fff; border:1px solid #EEE; border-radius:12px; margin:10px 0}
    .step .dot{position:absolute; right:-2px; top:14px; width:14px; height:14px; background:var(--maroon); border-radius:20px; border:3px solid #FDECEC}

    .badge{display:inline-flex; gap:8px; align-items:center; padding:6px 10px; border-radius:999px; font-size:13px; border:1px solid #EEE; background:#fff}
    .badge i{color:var(--info)}
    .ok{color:var(--success)}
    .warn{color:var(--warning)}

    footer{margin-top:36px; background:#1f0f0f; color:#fff; padding:16px}
    footer a{color:#FFCFBF}

    /* Icon utility classes */
    .icon{display:inline-block; line-height:1; vertical-align:middle}
    .icon i{display:inline-block}
    .icon--sm i{font-size:14px}
    .icon--md i{font-size:18px}
    .icon--lg i{font-size:24px}
    .icon--xl i{font-size:32px}

    /* Brand-aligned colors */
    .icon--maroon i{color:var(--maroon)}
    .icon--muted i{color:var(--muted)}
    .icon--ok i{color:var(--success)}
    .icon--warn i{color:var(--warning)}
    .icon--info i{color:var(--info)}

    /* Motion utilities */
    @media (prefers-reduced-motion: no-preference) {
      @keyframes pulse {0%{transform:scale(1)} 50%{transform:scale(1.06)} 100%{transform:scale(1)}}
      @keyframes floatY {0%{transform:translateY(0)} 100%{transform:translateY(-4px)}}
      @keyframes wiggle {0%,100%{transform:rotate(0)} 25%{transform:rotate(-2deg)} 75%{transform:rotate(2deg)}}
      @keyframes spinSlow {to{transform:rotate(360deg)}}
      .anim-pulse{animation:pulse 1.8s ease-in-out infinite}
      .anim-float{animation:floatY 2.8s ease-in-out infinite alternate}
      .hover-wiggle:hover{animation:wiggle 450ms ease-in-out}
      .anim-spin-slow{animation:spinSlow 6s linear infinite}
      .timeline .dot{animation:pulse 2.2s ease-in-out infinite}
    }
    @media (prefers-reduced-motion: reduce) { .anim-pulse, .anim-float, .hover-wiggle, .anim-spin-slow, .timeline .dot { animation: none !important } }
  </style>
</head>
<body>
  <header class="hero">
    <div class="container">
      <div class="brand"><i class="fa fa-school anim-pulse"></i></div>
      <div class="title">
        <h1>خطة تطوير منصة المدرسة</h1>
        <p>وثيقة تنفيذية شاملة لتحويل المنصة إلى تجربة حديثة عالية الأداء مع دعم كامل للعربية وRTL</p>
        <div class="toolbar">
          <a class="btn" href="#roadmap"><i class="fa fa-route"></i> خريطة الطريق</a>
          <a class="btn secondary" href="#kpis"><i class="fa fa-gauge-high"></i> مؤشرات النجاح</a>
          <a class="btn secondary" href="#tasks"><i class="fa fa-list-check"></i> المهام</a>
        </div>
      </div>
    </div>
  </header>

  <main class="container" style="margin-top:-18px">

    <section class="section">
      <div class="grid cols-3">
        <div class="card">
          <h3><i class="fa fa-rocket"></i> الهدف</h3>
          <p class="lead">أداء عالٍ، تجربة حديثة، دعم عربي وRTL، أمان، أوفلاين، وCI/CD.</p>
          <div class="kpi"><i class="fa fa-shield"></i> <div><b>أمان</b> عبر JWT/جلسات + RBAC دقيق + سياسات CORS/CSP</div></div>
        </div>
        <div class="card">
          <h3><i class="fa fa-layer-group"></i> التقنية</h3>
          <p class="lead">Backend: Django + PostgreSQL + Redis + RQ — Frontend: Vite + Vue 3</p>
          <ul class="list">
            <li><i class="fa fa-plug"></i> Vue Router + Pinia + Vue Query + i18n + PWA</li>
            <li><i class="fa fa-screwdriver-wrench"></i> DRF + SimpleJWT أو جلسات + CSRF</li>
          </ul>
        </div>
        <div class="card">
          <h3><i class="fa fa-clipboard-check"></i> المخرجات</h3>
          <ul class="list">
            <li><i class="fa fa-person-chalkboard"></i> وحدة حضور End‑to‑End مع أوفلاين ومزامنة</li>
            <li><i class="fa fa-chart-line"></i> تحسين أداء + مراقبة Sentry + Healthchecks</li>
          </ul>
        </div>
      </div>
    </section>

    <section id="roadmap" class="section">
      <h2><i class="fa fa-map"></i> خريطة الطريق المرحلية</h2>
      <div class="timeline">
        <div class="step">
          <span class="dot"></span>
          <h3>المرحلة 0 — تشغيل البيئة والتحقق</h3>
          <p class="muted">تشغيل dev_up/dev_all، صحة /healthz و/livez، عامل RQ.</p>
          <div class="badge"><i class="fa fa-terminal"></i> scripts/dev_up.ps1 · scripts/dev_all.ps1</div>
        </div>
        <div class="step">
          <span class="dot"></span>
          <h3>المرحلة 1 — الحوكمة والمعمارية</h3>
          <ul class="list">
            <li><i class="fa fa-diagram-project"></i> تنظيم frontend/src (app, services, modules, shared)</li>
            <li><i class="fa fa-user-shield"></i> DRF + JWT/جلسات + RBAC للأذونات</li>
          </ul>
        </div>
        <div class="step">
          <span class="dot"></span>
          <h3>المرحلة 2 — i18n + RTL + الوصولية</h3>
          <p class="muted">تعريب كامل، اتجاه ديناميكي، قواعد A11y.</p>
        </div>
        <div class="step">
          <span class="dot"></span>
          <h3>المرحلة 3 — الحضور كطيّار End‑to‑End</h3>
          <ul class="list">
            <li><i class="fa fa-database"></i> نموذج Attendance + فهارس (class_id,date)</li>
            <li><i class="fa fa-server"></i> DRF: GET/POST /api/attendance</li>
            <li><i class="fa fa-bolt"></i> Vue Query + تفاؤل + اختصارات P/A/L</li>
            <li><i class="fa fa-wifi"></i> PWA + Background Sync/Queue للأوفلاين</li>
            <li><i class="fa fa-wave-square"></i> Realtime عبر Channels/Socket</li>
          </ul>
        </div>
        <div class="step">
          <span class="dot"></span>
          <h3>المرحلة 4 — الدرجات والجداول والإشعارات</h3>
          <p class="muted">Workflow نشر الدرجات + Timetable + مركز إشعارات.</p>
        </div>
        <div class="step">
          <span class="dot"></span>
          <h3>المرحلة 5 — الأمان والمراقبة</h3>
          <ul class="list">
            <li><i class="fa fa-cookie-bite"></i> Access قصير + Refresh HttpOnly</li>
            <li><i class="fa fa-bug"></i> Sentry + Logs JSON مع request_id</li>
            <li><i class="fa fa-heart-pulse"></i> Healthchecks ضمن CI</li>
          </ul>
        </div>
        <div class="step">
          <span class="dot"></span>
          <h3>المرحلة 6 — الأداء</h3>
          <ul class="list">
            <li><i class="fa fa-box-open"></i> Code-splitting وdefineAsyncComponent</li>
            <li><i class="fa fa-database"></i> select_related/prefetch_related + فهارس DB</li>
          </ul>
        </div>
        <div class="step">
          <span class="dot"></span>
          <h3>المرحلة 7 — CI/CD والاختبارات</h3>
          <p class="muted">GitHub Actions للبناء والاختبارات ونشر artefacts.</p>
        </div>
      </div>
    </section>

    <section id="tasks" class="section">
      <h2><i class="fa fa-list-check"></i> قائمة المهام التنفيذية</h2>
      <div class="grid cols-3">
        <div class="card">
          <h3>Backend</h3>
          <ul class="list">
            <li><i class="fa fa-key"></i> تفعيل DRF + المصادقة (JWT/جلسات)</li>
            <li><i class="fa fa-user-lock"></i> RBAC: attendance:read/write, grades:publish</li>
            <li><i class="fa fa-database"></i> نمذجة Attendance + اختبارات API</li>
          </ul>
        </div>
        <div class="card">
          <h3>Frontend</h3>
          <ul class="list">
            <li><i class="fa fa-route"></i> Router Guards + Pinia</li>
            <li><i class="fa fa-cloud-arrow-down"></i> Vue Query + Axios Interceptors</li>
            <li><i class="fa fa-language"></i> i18n + RTL + A11y</li>
          </ul>
        </div>
        <div class="card">
          <h3>منصة التشغيل</h3>
          <ul class="list">
            <li><i class="fa fa-microchip"></i> Redis/RQ Jobs للإشعارات والتقارير</li>
            <li><i class="fa fa-shield-halved"></i> سياسات CORS/CSP وحماية XSS</li>
            <li><i class="fa fa-gears"></i> CI (Actions) للبناء والاختبارات</li>
          </ul>
        </div>
      </div>
    </section>

    <section id="kpis" class="section">
      <h2><i class="fa fa-gauge-high"></i> مؤشرات نجاح قابلة للقياس</h2>
      <div class="grid cols-3">
        <div class="card">
          <h3><i class="fa fa-bolt ok"></i> الأداء</h3>
          <ul class="list">
            <li><i class="fa fa-stopwatch"></i> شاشة الحضور الأولى < 1.5 ثانية</li>
            <li><i class="fa fa-signal"></i> API الشائعة < 200ms (P50)</li>
            <li><i class="fa fa-file-zipper"></i> حزم الواجهة مضغوطة + تقسيم</li>
          </ul>
        </div>
        <div class="card">
          <h3><i class="fa fa-lock ok"></i> الأمان</h3>
          <ul class="list">
            <li><i class="fa fa-cookie-bite"></i> Refresh بملف تعريف HttpOnly</li>
            <li><i class="fa fa-ban"></i> منع XSS وتعقيم المدخلات</li>
            <li><i class="fa fa-user-shield"></i> RBAC مفعل بجميع الشاشات</li>
          </ul>
        </div>
        <div class="card">
          <h3><i class="fa fa-eye ok"></i> المراقبة</h3>
          <ul class="list">
            <li><i class="fa fa-bug"></i> Sentry: أخطاء < 1% من الجلسات</li>
            <li><i class="fa fa-heart-pulse"></i> Healthchecks في CI/Prod</li>
            <li><i class="fa fa-database"></i> نسخ احتياطي Postgres مجدول</li>
          </ul>
        </div>
      </div>
    </section>

    <section class="section">
      <h2><i class="fa fa-timeline"></i> جدول زمني مقترح (3 أسابيع)</h2>
      <div class="timeline">
        <div class="step"><span class="dot"></span>
          <b>الأسبوع 1:</b> حوكمة + مصادقة + i18n/RTL
        </div>
        <div class="step"><span class="dot"></span>
          <b>الأسبوع 2:</b> الحضور End‑to‑End + PWA/Offline + Realtime
        </div>
        <div class="step"><span class="dot"></span>
          <b>الأسبوع 3:</b> الدرجات/الجداول + الأمان/المراقبة + CI/CD
        </div>
      </div>
    </section>

    <section class="section">
      <h2><i class="fa fa-book"></i> تعليمات تشغيل سريعة</h2>
      <ul class="list">
        <li><i class="fa fa-terminal"></i> إعداد البيئة: <code>scripts/dev_setup.ps1</code></li>
        <li><i class="fa fa-server"></i> تشغيل شامل: <code>scripts/dev_up.ps1</code> أو <code>scripts/dev_all.ps1</code></li>
        <li><i class="fa fa-person-digging"></i> عامل المهام: <code>scripts/rq_worker.ps1 -Queue default</code></li>
      </ul>
    </section>

    <section id="iconography" class="section">
      <h2><i class="fa fa-icons"></i> نظام الأيقونات المعتمد (Brand Iconography)</h2>
      <p class="muted">استخدم الأسماء الدلالية والأنماط أدناه للحصول على أيقونات احترافية متسقة مع الهوية المارونية.</p>
      <div class="grid cols-3">
        <div class="card">
          <h3>أحجام قياسية</h3>
          <p>
            <span class="icon icon--sm icon--maroon" title="صغير"><i class="fa fa-user"></i></span>
            <span class="icon icon--md icon--maroon" title="متوسط"><i class="fa fa-user"></i></span>
            <span class="icon icon--lg icon--maroon" title="كبير"><i class="fa fa-user"></i></span>
            <span class="icon icon--xl icon--maroon" title="كبير جدًا"><i class="fa fa-user"></i></span>
          </p>
          <p class="muted">اختر الحجم حسب السياق: 14/18/24/32px.</p>
        </div>
        <div class="card">
          <h3>ألوان الهوية</h3>
          <p>
            <span class="icon icon--lg icon--maroon" title="أساسي"><i class="fa fa-school"></i></span>
            <span class="icon icon--lg icon--ok" title="نجاح"><i class="fa fa-check-circle"></i></span>
            <span class="icon icon--lg icon--warn" title="تحذير"><i class="fa fa-triangle-exclamation"></i></span>
            <span class="icon icon--lg icon--info" title="معلومة"><i class="fa fa-circle-info"></i></span>
            <span class="icon icon--lg icon--muted" title="هادئ"><i class="fa fa-circle"></i></span>
          </p>
        </div>
        <div class="card">
          <h3>خرائط دلالية مقترحة</h3>
          <ul class="list">
            <li><i class="fa fa-person-chalkboard"></i> attendance → fa-person-chalkboard</li>
            <li><i class="fa fa-clipboard-list"></i> grades → fa-clipboard-list</li>
            <li><i class="fa fa-calendar-days"></i> timetable → fa-calendar-days</li>
            <li><i class="fa fa-bell"></i> notifications → fa-bell</li>
            <li><i class="fa fa-users"></i> users → fa-users</li>
          </ul>
        </div>
      </div>
      <div class="card" style="margin-top:12px">
        <h3>مثال استخدام HTML</h3>
        <pre style="white-space:pre-wrap; background:#fafafa; padding:12px; border-radius:10px; border:1px solid #eee"><code>&lt;button class="btn" aria-label="إضافة طالب"&gt;
  &lt;span class="icon icon--md icon--maroon" aria-hidden="true"&gt;&lt;i class="fa fa-user-plus"&gt;&lt;/i&gt;&lt;/span&gt;
  إضافة طالب
&lt;/button&gt;</code></pre>
        <p class="muted">تأكد من وجود aria-label أو نص مرئي للأزرار التي تحتوي على أيقونة فقط.</p>
      </div>
    </section>

  </main>

  <footer>
    <div class="container" style="display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap">
      <div>
        <b>منصة المدرسة</b> — هوية لونية: ماروني | جميع الحقوق محفوظة
      </div>
      <div class="badge"><i class="fa fa-circle-info"></i> هذا المستند مرجعي للتنفيذ — الإصدار 1.0</div>
    </div>
  </footer>
</body>
</html>