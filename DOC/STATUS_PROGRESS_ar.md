# حالة التقدّم وفق الخطة (ملخّص سريع)

- المرحلة 0 — التشغيل الآمن محليًا: مكتملة عمليًا
  - HTTPS dev يعمل عبر scripts/serve_https.ps1 مع اختيار منفذ تلقائي وكتابة backend/.runtime/dev_origin.txt
  - نقاط الصحة:
    - livez: backend/core/urls.py → تعريف الدالة ~سطر 41، المسار ~سطر 84
    - healthz: مفعّلة ومغطّاة بالاختبارات
  - سكربت dev_all.ps1 ينتظر جاهزية /livez ثم يشغّل Vite ويضبط VITE_BACKEND_ORIGIN/PORT
    - الأسطر ذات الصلة: 52–103 (الانتظار والاكتشاف)، 105–113 (الحقلان VITE_*)

- المرحلة 1 — الحوكمة والمعمارية: الأساسيات موجودة، بحاجة صقل لاحق
  - DRF + SimpleJWT مهيّأ (backend/core/settings_base.py: كتلة SIMPLE_JWT والكوكيز)
  - Linters/Formatters موجودة في المتطلبات، يمكن تعزيزها لاحقًا

- الاختبارات ذات الصلة:
  - tests/test_health.py: يغطي /livez و/healthz (تعريفات عند بدايات الملف: سطور 9–13 تقريبًا)

المهمة التالية المقترحة (وفق الترتيب بالخطة):
- المرحلة 2 — i18n + RTL + الوصولية (بدأ التنفيذ)
  - i18n: تم توصيل vue-i18n بالتطبيق (ar افتراضيًا، en احتياطيًا) مع كشف تلقائي وتخزين اختيار المستخدم.
  - dir: يتم ضبط سمة dir/lang على عنصر html تلقائيًا حسب اللغة (RTL للعربية).
  - UI: تمت إضافة مُبدِّل لغات مرئي في الترويسة (ع/EN) ويعمل فورًا ويحفظ التفضيل.
  - PrimeVue: تم ربط locale الخاصة بـ PrimeVue ديناميكيًا لتتبع لغة الواجهة فور التبديل (أيام/أشهر/رسائل).
  - A11y: تم دمج فحص @axe-core/vue لبيئة التطوير فقط + إضافة رابط "تجاوز إلى المحتوى" وأنماط :focus-visible + مُعلِن مسار Route Announcer (aria-live="polite").
  - RTL: تم استبدال خصائص اتجاهية بخصائص منطقية في بعض الأنماط، وسيستكمل التدقيق لاحقًا.
  - DoD المستهدف: axe-core بلا مخالفات حرجة على الصفحات الأساسية، تبديل اللغات يعمل عبر واجهة مرئية، ومكوّنات PrimeVue تتبع اللغة.

بدائل حسب الأولوية:
- البديل A: إكمال صقل المرحلة 1 (linters/formatters وتثبيت حزم الفرونت الأساسية)
- البديل B: القفز مباشرة للمرحلة 3 — وحدة الحضور Pilot E2E إذا كانت أولوية العمل الوظيفي أعلى

## الخطوات التالية الفورية (حسب الخطة)
- إتمام المرحلة 2 — i18n + RTL + الوصولية:
  - مراجعة سريعة بمساعدة axe (اختياري في التطوير) وإغلاق المخالفات الحرجة على الصفحات الأساسية (الرئيسية، الدخول، الجداول).
  - تدقيق RTL خفيف: استبدال الخصائص الاتجاهية المتبقية بخصائص منطقية حيثما كان آمنًا.
  - تمّ إصلاحان RTL إضافيان اليوم: استبدال left بـ inset-inline-start لكل من نقطة المؤشر الخضراء وعلامة العدّ التنازلي في TeacherTimetable.vue.
    - إضافة إصلاح للجوال: ضمن media query (max-width: 576px) تم استبدال left بـ inset-inline-start لشارة العدّ التنازلي.
  - إصلاح RTL إضافي: في ProfilePage.vue تم استبدال left: 50% بـ inset-inline-start: 50% لموضع تلميح الزر (tooltip).
  - إصلاحات RTL جديدة (اليوم):
    - BreadcrumbRtl.vue: استبدال right/left بعناصر منطقية (inset-inline-end و inset-inline) لقائمة الطيّ ونتائج البحث.
    - TeacherTimetable.vue: تثبيت عمود اليوم sticky باستخدام inset-inline-end بدل right.
    - design-system.css: استبدال border-right بـ border-inline-end في تنويعات التنبيهات (success/warning/danger/info) لدعم RTL/LTR.
  - توثيق ما تم حله وما سيُؤجل كبنود غير حرجة.
  - المرحلة B — Linters/Formatters:
    - إعداد ESLint + Prettier للواجهة مع سكربتات npm (lint/format) وتشغيلها ضمن verify.
    - إعداد Ruff + Black + isort للباك وتشغيلها ضمن verify.
  - المرحلة C — Pilot وحدة الحضور:
    - نموذج Attendance + ViewSet مع فلاتر (date,classId) وصلاحيات أساسية.
    - شاشة إدخال سريعة بالـ Vue Query وتوستس + اختبار بسيط.

  آخر تحديث: 2025-10-28 11:51 (محلي)

## المهام المتبقية (مختصر تنفيذي)
- المرحلة 2 — i18n + RTL + الوصولية (إغلاق متبقٍ):
  - فحص axe (اختياري في التطوير عند تفعيله) على الصفحات الأساسية (الرئيسية/الدخول/الجدول/الغياب) ومعالجة المخالفات الحرجة فقط.
  - تدقيق RTL خفيف: استبدال أي خصائص left/right وmargin/padding-left/right بخصائص منطقية inline-start/inline-end حيثما كان آمنًا.
  - التحقق من المعالم الدلالية للوصولية: header role="navigation" (منجز)، main role="main" + tabindex="-1" (منجز)، وتوفير aria-label لأي أزرار أيقونية بلا نص.
  - تحديث هذا المستند لتوثيق ما أُغلق وما تم تأجيله كغير حرج.
  - DoD: لا مخالفات axe حرجة على الصفحات الأساسية + واجهة تعمل بشكل صحيح في RTL/LTR + تبديل اللغات يحدّث PrimeVue.

- المرحلة B — Linters/Formatters (الحوكمة):
  - الواجهة: إضافة ESLint + Prettier بإعداد بسيط وسكربتات npm (lint، lint:fix، format) وتشغيلها ضمن verify.
  - الباكيند: تفعيل Ruff + Black + isort عبر pyproject.toml/الإعدادات الحالية وإضافة مهام تشغيل واضحة.
  - ربط الاثنين بمسار scripts/ops_run.ps1 -Task verify بحيث تُنفَّذ الفحوص محليًا بسهولة.
  - DoD: verify يمرّ على مشروع نظيف بدون أخطاء لِنتر.

- المرحلة C — Pilot وحدة الحضور (Skeleton):
  - Backend: نقاط API جاهزة (students/records/teacher/classes/history-strict/bulk_save) ضمن AttendanceViewSetV2 ✓
  - Tests (pytest): سيناريوهات أساسية تمر (SQLite/PG) بما في ذلك bulk_save ✓
  - Frontend: صفحة TeacherAttendance.vue محمولة بالكامل (تحميل/حفظ تفاؤلي + صف أوفلاين + Toasts) ✓
  - DoD: المعلّم قادر على تسجيل الحضور محليًا، والاختبارات الأساسية تمر ✓

- التوثيق وتجربة المطوّر:
  - تحديث GETTING_STARTED_ar.md وSTATUS_PROGRESS_ar.md بما يعكس إعدادات اللنتر وكيفية تشغيلها، وواجهات وحدة الحضور عند إضافتها.
  - إبقاء @axe-core/vue اختياريًا ومحمِيًا بالعلم VITE_ENABLE_AXE، مع توضيح كيفية تفعيله عند الحاجة.

- الخطوة التالية مباشرة:
  - استكمال تدقيق RTL الخفيف المتبقي ثم تفعيل مهام Linters/Formatters (المرحلة B) وربطها بمسار verify.

ملاحظة التحديث: 2025-10-28 11:49 (محلي)